{"version":3,"file":"ResizeImage.js","sources":["../src/parts/Canvas.js","../src/parts/events.js","../src/parts/defaultOptions.js","../src/parts/resizeImage.js","../src/parts/output.js","../src/ResizeImage.js"],"sourcesContent":["/**\n * Canvas\n *\n * @param {Number} width\n * @param {Number} height\n * @param {String} bgColor\n */\nexport default function Canvas(width=320, height=240, bgColor='#ffffff') {\n\n\tthis.el = document.createElement('canvas');\n\tthis.ctx = this.el.getContext('2d');\n\n\tthis.el.width = width;\n\tthis.el.height = height;\n\n\tthis.ctx.fillStyle = bgColor;\n\tthis.ctx.fillRect(0, 0, width, height);\n\n}\n","/**\n * load image\n *\n * @param {String} src\n * @return {Promise}\n */\nexport function loadImage(src)\n{\n\treturn new Promise((resolve, reject) => {\n\t\tif (src)\n\t\t{\n\t\t\tlet image = new Image();\n\n\t\t\timage.onload = function(e)\n\t\t\t{\n\t\t\t\tresolve(image);\n\t\t\t};\n\t\t\timage.onerror = function(e)\n\t\t\t{\n\t\t\t\treject(e);\n\t\t\t};\n\n\t\t\timage.setAttribute('crossOrigin', 'anonymous');\n\t\t\timage.src = src;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treject(new Error('no src'));\n\t\t}\n\t});\n}","export const base = {\n\n\tquality: .75,\n\tformat: 'jpg', // png,jpg\n\toutputType: 'base64', // base64, canvas, blob\n\twidth: 320,\n\theight: null,\n\treSample: 2,\n\tbgColor: '#ffffff',\n\tsaveExif: false,\n\n};\n","import Canvas from '../parts/Canvas';\n\n\n// default options\nconst defaultOptions = {\n\tcanvas: null,\n\treSample: 2,\n\twidth: 320,\n\theight: 240,\n\tcx: 0,\n\tcy: 0,\n\tcw: 0,\n\tch: 0,\n\tdx: 0,\n\tdy: 0,\n\tdw: 0,\n\tdh: 0,\n\tbgColor: '#ffffff',\n};\n\n\n/**\n * Resize canvas\n *\n * @param {Object} options\n * @param {Number} count\n * @param {HTMLCanvasElement} parentCanvas\n * @return {Promise}\n */\nfunction resize(options, count, parentCanvas)\n{\n\treturn new Promise(resolve => {\n\t\tfunction func(count, parentCanvas)\n\t\t{\n\t\t\tconst pow = Math.pow(2, count);\n\t\t\tlet canvasForResize = new Canvas(\n\t\t\t\toptions.width * pow,\n\t\t\t\toptions.height * pow,\n\t\t\t\toptions.bgColor\n\t\t\t);\n\n\t\t\tcanvasForResize.ctx.drawImage(\n\t\t\t\tparentCanvas,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tparentCanvas.width * 0.5,\n\t\t\t\tparentCanvas.height * 0.5,\n\t\t\t);\n\n\t\t\tif (count > 0)\n\t\t\t{\n\t\t\t\tfunc(count - 1, canvasForResize.el);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(canvasForResize.el);\n\t\t\t}\n\t\t}\n\n\t\tfunc(count - 1, parentCanvas);\n\t});\n}\n\n\n/**\n * Resize image\n *\n * @param {Object} options\n * @return {Promise}\n */\nexport default function resizeImage(options)\n{\n\t// assign options\n\toptions = Object.assign({}, defaultOptions, options);\n\n\t// set resampling count\n\toptions.reSample = Math.min(4, options.reSample);\n\toptions.reSample = Math.max(0, options.reSample);\n\tconst reSamplingCount = Math.pow(2, options.reSample);\n\n\treturn new Promise(function(resolve, reject) {\n\t\ttry\n\t\t{\n\t\t\tconst canvas = new Canvas(\n\t\t\t\toptions.width * reSamplingCount,\n\t\t\t\toptions.height * reSamplingCount,\n\t\t\t\toptions.bgColor\n\t\t\t);\n\n\t\t\tcanvas.ctx.drawImage(\n\t\t\t\toptions.canvas,\n\t\t\t\toptions.cx,\n\t\t\t\toptions.cy,\n\t\t\t\toptions.cw,\n\t\t\t\toptions.ch,\n\t\t\t\toptions.dx * reSamplingCount,\n\t\t\t\toptions.dy * reSamplingCount,\n\t\t\t\toptions.dw * reSamplingCount,\n\t\t\t\toptions.dh * reSamplingCount\n\t\t\t);\n\n\t\t\tif (options.reSample > 0)\n\t\t\t{\n\t\t\t\tresize(options, options.reSample, canvas.el).then(resolve);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresolve(canvas.el);\n\t\t\t}\n\t\t}\n\t\tcatch(e)\n\t\t{\n\t\t\treject(e);\n\t\t}\n\t});\n\n}\n","\n/**\n * type - base64\n *\n * @param {HTMLCanvasElement} canvas\n * @param {String} format\n * @param {Number} quality\n * @return {Promise}\n */\nexport function base64(canvas, format='image/jpeg', quality=.75)\n{\n\t// set format\n\tformat = getFormat(format);\n\n\treturn new Promise(function(resolve, reject) {\n\t\ttry {\n\t\t\tconst uri = canvas.toDataURL(format, quality);\n\t\t\tresolve(uri);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\treject(e);\n\t\t}\n\t});\n}\n\n\n/**\n * type - blob\n *\n * @param {HTMLCanvasElement} canvas\n * @param {String} format\n * @param {Number} quality\n * @return {Promise}\n */\nexport function blob(canvas, format='image/jpeg', quality=.75)\n{\n\t// set format\n\tformat = getFormat(format);\n\n\treturn new Promise(function(resolve, reject) {\n\t\ttry {\n\t\t\tconst uri = canvas.toDataURL(format, quality);\n\t\t\tconst blob = dataURItoBlob(uri);\n\t\t\tresolve(blob);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\treject(e);\n\t\t}\n\t});\n}\n\n\n/**\n * Get format\n *\n * @param {String} str\n * @return {String}\n */\nfunction getFormat(str)\n{\n\tlet format = null;\n\n\tswitch(str)\n\t{\n\t\tcase 'jpg':\n\t\tcase 'jpeg':\n\t\t\tformat = 'image/jpeg';\n\t\t\tbreak;\n\t\tcase 'png':\n\t\t\tformat = 'image/png';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tformat = str;\n\t\t\tbreak;\n\t}\n\n\treturn format\n}\n\n\n/**\n * Data uri to Blob\n * source : https://gist.github.com/davoclavo/4424731\n *\n * @param {String} dataURI\n * @return {Blob}\n */\nfunction dataURItoBlob(dataURI)\n{\n\t// convert base64 to raw binary data held in a string\n\tconst byteString = atob(dataURI.split(',')[1]);\n\n\t// separate out the mime component\n\tconst mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n\n\t// write the bytes of the string to an ArrayBuffer\n\tconst arrayBuffer = new ArrayBuffer(byteString.length);\n\tlet _ia = new Uint8Array(arrayBuffer);\n\tfor (let i = 0; i < byteString.length; i++)\n\t{\n\t\t_ia[i] = byteString.charCodeAt(i);\n\t}\n\n\tconst dataView = new DataView(arrayBuffer);\n\tconst blob = new Blob([dataView], { type: mimeString });\n\n\treturn blob;\n}","import Canvas from './parts/Canvas';\nimport * as events from './parts/events';\nimport * as defaultOptions from './parts/defaultOptions';\nimport resizeImage from './parts/resizeImage';\nimport * as output from './parts/output';\n\n\n/**\n * Resize image\n *\n * @param {Object} getOptions\n */\nfunction ResizeImage(getOptions) {\n\n\tlet options = null;\n\n\t// assign options\n\tthis.options = checkOptions(defaultOptions.base, getOptions);\n\n\n\t/**\n\t * FUNCTION AREA\n\t */\n\n\t/**\n\t * Check options\n\t *\n\t * @param {Object} original\n\t * @param {Object} target\n\t */\n\tfunction checkOptions(original={}, target={})\n\t{\n\t\tlet result = {};\n\n\t\tObject.keys(original).forEach(function(key) {\n\t\t\tresult[key] = target[key] || original[key];\n\t\t});\n\n\t\tresult.width = Number(result.width);\n\t\tresult.height = Number(result.height);\n\t\tresult.quality = Number(result.quality);\n\t\tresult.reSample = Number(result.reSample);\n\n\t\treturn result;\n\t}\n\n\t/**\n\t * Image source to canvas\n\t * 이미지 주소로 캔버스로 변환\n\t *\n\t * @param {String} src\n\t * @param {Object} options\n\t * @return {Promise}\n\t */\n\tfunction srcToCanvas(src, options)\n\t{\n\t\tlet canvas = null;\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tevents.loadImage(src).then(\n\t\t\t\t// resolve\n\t\t\t\tfunction(img)\n\t\t\t\t{\n\t\t\t\t\t// TODO : exif 데이터 가져오기\n\t\t\t\t\tcanvas = new Canvas(img.width, img.height, options.bgColor);\n\t\t\t\t\tcanvas.ctx.drawImage(img, 0, 0);\n\t\t\t\t\tresolve(canvas.el);\n\t\t\t\t},\n\t\t\t\t// reject\n\t\t\t\tfunction(error)\n\t\t\t\t{\n\t\t\t\t\treject(error);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Upload to image\n\t * 첨부로 가져온 이미지를 캔버스로 변환\n\t *\n\t * @param {HTMLElement} el\n\t * @param {Object} options\n\t * @return {Promise}\n\t */\n\tfunction formToCanvas(el, options)\n\t{\n\t\tlet canvas = null;\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tfunction error(e)\n\t\t\t{\n\t\t\t\treject(e);\n\t\t\t}\n\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = function(e)\n\t\t\t{\n\t\t\t\tconst img = new Image();\n\t\t\t\timg.onload = function()\n\t\t\t\t{\n\t\t\t\t\t// TODO : exif 데이터 가져오기\n\t\t\t\t\tcanvas = new Canvas(img.width, img.height, options.bgColor);\n\t\t\t\t\tcanvas.ctx.drawImage(img, 0, 0);\n\t\t\t\t\tresolve(canvas.el);\n\t\t\t\t};\n\t\t\t\timg.onerror = error;\n\t\t\t\timg.src = e.target.result;\n\t\t\t};\n\t\t\treader.onerror = error;\n\t\t\treader.readAsDataURL(el.files[0]);\n\t\t});\n\t}\n\n\n\t/**\n\t * METHOD AREA\n\t */\n\n\t/**\n\t * Play convert\n\t * 이미지 변환 실행\n\t * 이미지 주소로 캔버스로 변환 -> 캔버스를 리사이즈 -> 이미지로 컨버트\n\t *\n\t * @param {String|HTMLElement} src\n\t * @return {Promise}\n\t */\n\tthis.play = function(src)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.get(src)\n\t\t\t\t.then((canvas) => this.resize(canvas))\n\t\t\t\t.then((canvas) => this.output(canvas))\n\t\t\t\t.then((result) => resolve(result))\n\t\t\t\t.catch((error) => reject(error));\n\t\t});\n\t};\n\n\t/**\n\t * Get source\n\t *\n\t * @param {String|HTMLElement} src\n\t * @param {Object} options\n\t * @return {Promise}\n\t */\n\tthis.get = function(src, options)\n\t{\n\t\toptions = options ? checkOptions(this.options, options) : this.options;\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (typeof src === 'string')\n\t\t\t{\n\t\t\t\t// image url\n\t\t\t\tresolve(srcToCanvas(src, options));\n\t\t\t}\n\t\t\telse if (typeof src === 'object')\n\t\t\t{\n\t\t\t\t// input[type=file] form\n\t\t\t\tresolve(formToCanvas(src, options));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treject(new Error('Not found source'));\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * Resize canvas\n\t *\n\t * @param {HTMLCanvasElement} canvas\n\t * @param {Object} options\n\t * @return {Promise}\n\t */\n\tthis.resize = function(canvas, options)\n\t{\n\t\toptions = options ? checkOptions(this.options, options) : this.options;\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t// get size\n\t\t\tlet size = getSize(canvas.width, canvas.height, options.width, options.height);\n\n\t\t\t// resize image\n\t\t\tresizeImage({\n\t\t\t\tcanvas: canvas,\n\t\t\t\treSample: options.reSample,\n\t\t\t\twidth: size.width,\n\t\t\t\theight: size.height,\n\t\t\t\tcx: 0,\n\t\t\t\tcy: 0,\n\t\t\t\tcw: canvas.width,\n\t\t\t\tch: canvas.height,\n\t\t\t\tdx: 0,\n\t\t\t\tdy: 0,\n\t\t\t\tdw: size.width,\n\t\t\t\tdh: size.height,\n\t\t\t\tbgColor: options.bgColor,\n\t\t\t})\n\t\t\t\t.then(resolve)\n\t\t\t\t.catch(reject);\n\t\t});\n\t};\n\n\t/**\n\t * Output data\n\t *\n\t * @param {HTMLCanvasElement} canvas\n\t * @param {Object} options\n\t * @return {Promise}\n\t */\n\tthis.output = function(canvas, options)\n\t{\n\t\toptions = !!options ? checkOptions(this.options, options) : this.options;\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tswitch (options.outputType)\n\t\t\t{\n\t\t\t\tcase 'base64':\n\t\t\t\t\toutput.base64(canvas, options.format, options.quality)\n\t\t\t\t\t\t.then(resolve)\n\t\t\t\t\t\t.catch(reject);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'blob':\n\t\t\t\t\toutput.blob(canvas, options.format, options.quality)\n\t\t\t\t\t\t.then(resolve)\n\t\t\t\t\t\t.catch(reject);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'canvas':\n\t\t\t\tdefault:\n\t\t\t\t\tresolve(canvas);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t};\n\n\t/**\n\t * Update options\n\t *\n\t * @param {Object} value\n\t * @return {ResizeImage}\n\t */\n\tthis.updateOptions = function(value)\n\t{\n\t\tthis.options = checkOptions(this.options, value);\n\t\treturn this;\n\t}\n}\n\n\n/**\n * Get image size\n *\n * @param {Number} width original width\n * @param {Number} height original height\n * @param {Number} targetWidth target width\n * @param {Number} targetHeight target height\n * @return {Object}\n */\nfunction getSize(width, height, targetWidth, targetHeight)\n{\n\tlet w = width;\n\tlet h = height;\n\n\tif (targetWidth && targetHeight)\n\t{\n\t\tif (targetWidth > targetHeight)\n\t\t{\n\t\t\ttargetHeight = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttargetWidth = null;\n\t\t}\n\t}\n\n\tif (targetWidth)\n\t{\n\t\tw = targetWidth;\n\t\th = height * (targetWidth / width);\n\t}\n\telse if (targetHeight)\n\t{\n\t\tw = width * (targetHeight / height);\n\t\th = targetHeight;\n\t}\n\n\treturn {\n\t\twidth: parseInt(w),\n\t\theight: parseInt(h)\n\t};\n}\n\n\nexport default ResizeImage;\n"],"names":["Canvas","width","height","bgColor","el","document","createElement","ctx","getContext","fillStyle","fillRect","loadImage","src","Promise","resolve","reject","image","Image","onload","e","onerror","setAttribute","Error","base","defaultOptions","resize","options","count","parentCanvas","func","pow","Math","canvasForResize","drawImage","resizeImage","Object","assign","reSample","min","max","reSamplingCount","canvas","cx","cy","cw","ch","dx","dy","dw","dh","then","base64","format","quality","getFormat","uri","toDataURL","blob","dataURItoBlob","str","dataURI","byteString","atob","split","mimeString","arrayBuffer","ArrayBuffer","length","_ia","Uint8Array","i","charCodeAt","dataView","DataView","Blob","type","ResizeImage","getOptions","checkOptions","original","target","result","keys","forEach","key","Number","srcToCanvas","img","error","formToCanvas","reader","FileReader","readAsDataURL","files","play","get","output","catch","size","getSize","outputType","updateOptions","value","targetWidth","targetHeight","w","h","parseInt"],"mappings":"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"}